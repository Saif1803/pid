<body>clc;clear all;
% Parameters
Rs = 0.47;
Lq = 1.23e-3;
B = 0.0002;
Kb = 0.42;
Kt = 0.73;
J = 6.5e-4;
% State-space Matrices of the Uncompensated Plant
A = [-B/J Kt/J;
-Kb/Lq -Rs/Lq];
B = [0;
1/Lq];
C = [1 0];
D = 0;
[a,b]=ss2tf(A,B,C,D)
g=tf(a,b)
% Reference trajectory design
wr = 3; % reference omega, ω
zr = 0.7; % reference zeta, ζ
nr = wr^2;
dr = [1 2*zr*wr wr^2]; % x" + 2·ζ·ω·x' + ω2·x
Gr = tf(nr, dr) % reference model
% Controller design
cp = pole(Gr) % controller poles
K = acker (A, B, transpose(cp)) % controller gains
% Closed-loop control system without observer
sys = ss(A-B*K, B, C, D);
Nbar = 1/dcgain(sys); % Normalizer (to rescale the reference input)
cls = ss(A-B*K, B*Nbar, C, D)
[c,d]=ss2tf(A-B*K, B*Nbar, C, D)
g1=tf(c,d)
% Observer design
or = 10*real(cp(1)); % make the observer response 10 times faster
op = [or+1 or-1] % observer poles (make op ≪ cp but no repeated poles)
L = place(A', C', op)' % observer gains
% Combine state-feedback controller and observer
Aco = [A-B*K B*K;
zeros(size(A)) A-L*C];
Bco = [B*Nbar;
zeros(size(B))];
Cco = [C zeros(size(C))];
Dco = 0;
% Closed-loop observer-based control system
clco = ss(Aco, Bco, Cco, Dco)
step(clco, 6), grid on
sys_open_loop = ss(A, B, C, D);
step(sys_open_loop, 6), grid on;
[e,f] = ss2tf(Aco, Bco, Cco, Dco)
g2=tf(e,f)
step(clco,sys_open_loop)
subplot(3, 1, 1);
step(g, 6);
title("open-loop control system ")
grid on;
subplot(3, 1, 2);
step(g1, 6);
title("Closed-loop control system without observer")
grid on;
subplot(3,1,3);
step(g2, 6);
title("Closed-loop control system observer")
grid on;</body>